<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Course Manager - GenZ IIITian</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Outfit', sans-serif; background: #050505; color: #e5e5e5; height: 100vh; overflow: hidden; }
        .glass { background: rgba(20, 20, 20, 0.6); backdrop-filter: blur(12px); border: 1px solid rgba(255,255,255,0.08); }
        .input-base { background: #0a0a0a; border: 1px solid #333; color: white; padding: 0.5rem; border-radius: 0.375rem; width: 100%; font-size: 0.875rem; transition: border-color 0.2s; }
        .input-base:focus { outline: none; border-color: #3b82f6; }
        .label { display: block; font-size: 0.75rem; color: #888; margin-bottom: 0.25rem; font-weight: 500; text-transform: uppercase; letter-spacing: 0.05em; }
        ::-webkit-scrollbar { width: 8px; height: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #555; }
        
        .tab-btn { padding: 0.5rem 1rem; font-size: 0.875rem; color: #888; border-bottom: 2px solid transparent; transition: all 0.2s; }
        .tab-btn.active { color: white; border-bottom-color: #3b82f6; }
        .week-card { border-left: 2px solid #333; padding-left: 1rem; margin-left: 0.5rem; }
    </style>
</head>
<body>
    <div id="app" class="flex h-full">
        <!-- Sidebar -->
        <div class="w-80 glass flex flex-col h-full border-r border-white/10 flex-shrink-0">
            <div class="p-4 border-b border-white/10 bg-black/20">
                <div class="flex items-center gap-2 mb-4">
                    <div class="w-8 h-8 rounded bg-gradient-to-tr from-blue-600 to-indigo-600 flex items-center justify-center font-bold">C</div>
                    <h1 class="font-bold text-lg tracking-tight">Course Manager</h1>
                </div>
                
                <div class="flex gap-2 mb-4 bg-black/40 p-1 rounded-lg">
                    <button @click="loadLevel('foundation')" :class="['flex-1 py-1.5 text-xs rounded-md transition', currentLevel=='foundation' ? 'bg-blue-600 text-white shadow' : 'text-gray-400 hover:text-white']">Foundation</button>
                    <button @click="loadLevel('diploma')" :class="['flex-1 py-1.5 text-xs rounded-md transition', currentLevel=='diploma' ? 'bg-blue-600 text-white shadow' : 'text-gray-400 hover:text-white']">Diploma</button>
                    <button @click="loadLevel('degree')" :class="['flex-1 py-1.5 text-xs rounded-md transition', currentLevel=='degree' ? 'bg-blue-600 text-white shadow' : 'text-gray-400 hover:text-white']">Degree</button>
                </div>

                <div class="relative">
                    <i class="fa-solid fa-search absolute left-3 top-2.5 text-gray-500 text-xs"></i>
                    <input v-model="searchQuery" class="input-base pl-8" placeholder="Search courses...">
                </div>
            </div>

            <div class="flex-1 overflow-y-auto p-2 space-y-1">
                <div v-if="loading" class="text-center p-4 text-gray-500 text-xs">Loading...</div>
                <div v-else-if="filteredCourses.length === 0" class="text-center p-4 text-gray-500 text-xs">No courses found</div>
                
                <div v-for="c in filteredCourses" :key="c.code" 
                     @click="selectCourse(c)"
                     :class="['p-3 rounded-lg cursor-pointer transition border border-transparent group', selectedCourse && selectedCourse.code === c.code ? 'bg-blue-600/10 border-blue-500/50' : 'hover:bg-white/5 hover:border-white/10']">
                    <div class="flex justify-between items-start">
                        <span class="text-xs font-mono text-blue-400 bg-blue-400/10 px-1.5 py-0.5 rounded">{{ c.code }}</span>
                        <span class="text-[10px] text-gray-500">{{ c.credits }} Cr</span>
                    </div>
                    <div class="font-medium text-sm mt-1 mb-0.5 truncate group-hover:text-blue-200">{{ c.name }}</div>
                </div>
            </div>
            
            <div class="p-3 border-t border-white/10 bg-black/20 flex gap-2">
                <button @click="saveFile" class="flex-1 bg-green-600 hover:bg-green-500 text-white py-2 rounded text-xs font-medium transition flex items-center justify-center gap-2">
                    <i class="fa-solid fa-save"></i> Save Changes
                </button>
            </div>
        </div>

        <!-- Main Content -->
        <div class="flex-1 flex flex-col h-full overflow-hidden bg-[#050505]">
            <div v-if="selectedCourse" class="h-full flex flex-col">
                <!-- Header -->
                <div class="p-6 border-b border-white/5 bg-black/10 flex justify-between items-center">
                    <div>
                        <h2 class="text-2xl font-bold">{{ selectedCourse.name }} <span class="text-gray-500 text-lg font-normal">{{ selectedCourse.code }}</span></h2>
                        <div class="text-xs text-gray-400 mt-1 flex gap-4">
                            <span><i class="fa-solid fa-layer-group mr-1.5"></i> {{ selectedCourse.level }}</span>
                            <span><i class="fa-regular fa-clock mr-1.5"></i> {{ selectedCourse.type }}</span>
                        </div>
                    </div>
                    <div>
                         <div class="flex bg-black/40 rounded-lg p-1">
                            <button @click="activeTab = 'meta'" :class="['py-1.5 px-4 text-xs rounded transition', activeTab==='meta' ? 'bg-gray-700 text-white' : 'text-gray-400 hover:text-white']">Metadata</button>
                            <button @click="activeTab = 'syllabus'" :class="['py-1.5 px-4 text-xs rounded transition', activeTab==='syllabus' ? 'bg-gray-700 text-white' : 'text-gray-400 hover:text-white']">Syllabus</button>
                            <button @click="activeTab = 'content'" :class="['py-1.5 px-4 text-xs rounded transition', activeTab==='content' ? 'bg-gray-700 text-white' : 'text-gray-400 hover:text-white']">Content</button>
                         </div>
                    </div>
                </div>

                <!-- Editor Area -->
                <div class="flex-1 overflow-y-auto p-8">
                    
                    <!-- Metadata Tab -->
                    <div v-if="activeTab === 'meta'" class="max-w-3xl space-y-6">
                        <div class="grid grid-cols-2 gap-4">
                            <div><label class="label">Course Name</label><input v-model="selectedCourse.name" class="input-base"></div>
                            <div><label class="label">Course Code</label><input v-model="selectedCourse.code" class="input-base"></div>
                            <div><label class="label">Primary ID</label><input v-model="selectedCourse.id" class="input-base text-gray-500" disabled></div>
                            <div><label class="label">Credits</label><input v-model.number="selectedCourse.credits" type="number" class="input-base"></div>
                            <div><label class="label">Fee (INR)</label><input v-model.number="selectedCourse.fee" type="number" class="input-base"></div>
                            <div><label class="label">Type</label>
                                <select v-model="selectedCourse.type" class="input-base">
                                    <option>Theory</option>
                                    <option>Project</option>
                                    <option>Lab</option>
                                </select>
                            </div>
                        </div>
                        
                        <div>
                            <label class="label">Description</label>
                            <textarea v-model="selectedCourse.description" class="input-base h-24" placeholder="Course description..."></textarea>
                        </div>
                        
                        <div>
                            <label class="label">Prerequisites (Codes)</label>
                            <div class="flex gap-2 flex-wrap">
                                <span v-for="(pre, idx) in selectedCourse.pre" :key="idx" class="bg-gray-800 px-2 py-1 rounded text-xs flex items-center gap-2">
                                    {{ pre }} <button @click="selectedCourse.pre.splice(idx, 1)" class="hover:text-red-500">Ã—</button>
                                </span>
                                <input @keydown.enter="addPre" placeholder="+ Add (Press Enter)" class="input-base w-32 !py-0.5 !text-xs">
                            </div>
                        </div>

                        <div>
                            <label class="label">Exams Config</label>
                            <div class="grid grid-cols-4 gap-4 bg-[#111] p-4 rounded border border-gray-800">
                                <label class="flex items-center gap-2 text-sm cursor-pointer"><input type="checkbox" v-model="selectedCourse.exams.q1"> Quiz 1</label>
                                <label class="flex items-center gap-2 text-sm cursor-pointer"><input type="checkbox" v-model="selectedCourse.exams.q2"> Quiz 2</label>
                                <label class="flex items-center gap-2 text-sm cursor-pointer"><input type="checkbox" v-model="selectedCourse.exams.et"> End Term</label>
                                <div class="flex items-center gap-2">
                                     <span class="text-sm">OPPEs:</span>
                                     <input type="number" v-model.number="selectedCourse.exams.oppe" class="input-base w-12 text-center py-0.5">
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Syllabus Tab -->
                    <div v-if="activeTab === 'syllabus'" class="max-w-2xl">
                        <div class="flex justify-between items-center mb-4">
                            <label class="label">Topics List</label>
                            <button @click="addSyllabusItem" class="text-xs bg-gray-800 hover:bg-gray-700 px-2 py-1 rounded"> + Add Topic</button>
                        </div>
                        <div class="space-y-2">
                             <div v-for="(topic, idx) in selectedCourse.syllabus" :key="idx" class="flex gap-2">
                                 <div class="bg-gray-800 px-3 py-2 rounded text-gray-500 font-mono text-xs w-8 flex items-center justify-center">{{ idx+1 }}</div>
                                 <input v-model="selectedCourse.syllabus[idx]" class="input-base">
                                 <button @click="selectedCourse.syllabus.splice(idx, 1)" class="text-gray-600 hover:text-red-500 px-2"><i class="fa-solid fa-trash"></i></button>
                             </div>
                        </div>
                    </div>

                    <!-- Content Tab (Weeks) -->
                    <div v-if="activeTab === 'content'" class="max-w-4xl space-y-6 pb-20">
                         <div v-if="!selectedCourse.weeks || selectedCourse.weeks.length === 0" class="text-center py-10 text-gray-500">
                             No content structure defined.
                             <button @click="initWeeks" class="block mx-auto mt-2 text-blue-500 hover:underline">Initialize 12 Weeks</button>
                         </div>

                         <div v-else class="space-y-4">
                             <div v-for="(week, wIdx) in selectedCourse.weeks" :key="wIdx" class="bg-[#111] border border-gray-800 rounded-lg overflow-hidden transition hover:border-gray-700">
                                 <!-- Week Header -->
                                 <div @click="toggleWeek(wIdx)" class="p-3 bg-gray-900/50 flex justify-between items-center cursor-pointer select-none">
                                     <div class="flex items-center gap-3">
                                         <span class="text-blue-500 font-mono text-xs font-bold w-12">WEEK {{ week.weekNum }}</span>
                                         <input v-model="week.title" @click.stop class="bg-transparent border-none text-sm font-medium focus:bg-black/50 rounded px-2 w-64 text-gray-300 focus:text-white" placeholder="Week Title">
                                     </div>
                                     <i :class="['fa-solid text-xs text-gray-600 transition', openWeeks.includes(wIdx) ? 'fa-chevron-up' : 'fa-chevron-down']"></i>
                                 </div>

                                 <!-- Week Body -->
                                 <div v-if="openWeeks.includes(wIdx)" class="p-4 border-t border-gray-800 space-y-6">
                                     
                                     <!-- Lectures -->
                                     <div>
                                         <div class="flex justify-between items-center mb-2">
                                             <label class="label text-blue-400">Lectures</label>
                                             <button @click="week.lectures.push({title:'New Lecture', youtubeId:'', duration:''})" class="text-[10px] bg-gray-800 px-2 py-0.5 rounded hover:bg-white/10">+ Add Lecture</button>
                                         </div>
                                         <div class="space-y-2">
                                             <div v-for="(lec, lIdx) in week.lectures" :key="lIdx" class="flex gap-2 items-center bg-black/40 p-2 rounded border border-white/5">
                                                 <span class="text-[10px] text-gray-600 w-4">{{ lIdx+1 }}</span>
                                                 <input v-model="lec.title" class="input-base !py-1 !text-xs flex-1" placeholder="Title">
                                                 <input v-model="lec.youtubeId" class="input-base !py-1 !text-xs w-24 font-mono text-yellow-500" placeholder="YT ID">
                                                 <input v-model="lec.duration" class="input-base !py-1 !text-xs w-16 text-center" placeholder="MM:SS">
                                                 <button @click="week.lectures.splice(lIdx, 1)" class="text-gray-600 hover:text-red-500 px-1"><i class="fa-solid fa-times"></i></button>
                                             </div>
                                         </div>
                                     </div>

                                     <!-- Notes -->
                                     <div>
                                         <div class="flex justify-between items-center mb-2">
                                             <label class="label text-green-400">Notes / Resources</label>
                                             <button @click="week.notes.push({title:'New Note', url:''})" class="text-[10px] bg-gray-800 px-2 py-0.5 rounded hover:bg-white/10">+ Add Resource</button>
                                         </div>
                                         <div class="space-y-2">
                                             <div v-for="(note, nIdx) in week.notes" :key="nIdx" class="flex gap-2 items-center bg-black/40 p-2 rounded border border-white/5">
                                                 <input v-model="note.title" class="input-base !py-1 !text-xs flex-1" placeholder="Resource Title">
                                                 <input v-model="note.url" class="input-base !py-1 !text-xs flex-1 text-blue-400" placeholder="URL">
                                                 <button @click="week.notes.splice(nIdx, 1)" class="text-gray-600 hover:text-red-500 px-1"><i class="fa-solid fa-times"></i></button>
                                             </div>
                                         </div>
                                     </div>
                                 </div>
                             </div>
                         </div>
                    </div>

                </div>
            </div>

            <div v-else class="h-full flex flex-col items-center justify-center text-gray-600">
                <i class="fa-solid fa-book-open text-4xl mb-4 opacity-20"></i>
                <p>Select a course to edit</p>
            </div>
        </div>
    </div>
    <script src="./src/app.js" type="module"></script>
</body>
</html>
