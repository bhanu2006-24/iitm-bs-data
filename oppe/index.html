<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GenZ | Dojo - Mix Edit Mode</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- CodeMirror -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/theme/dracula.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/python/python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/clike/clike.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/sql/sql.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.2/mode/shell/shell.min.js"></script>

    <link rel="stylesheet" href="./src/style.css">
</head>
<body>

    <div id="app" class="split-grid">
        
        <!-- Sidebar: Questions -->
        <div class="glass flex flex-col h-full border-r border-gray-800">
            <div class="p-5 border-b border-gray-800 bg-[#0d0d0d]">
                <h1 class="text-xl font-bold bg-gradient-to-r from-purple-400 to-pink-400 bg-clip-text text-transparent flex items-center gap-3 mb-4">
                    <i class="fa-solid fa-layer-group"></i> Dojo Mix
                </h1>
                <select v-model="selectedSubject" @change="loadSubject" class="input-base text-sm font-medium">
                    <option value="python">Python</option>
                    <option value="java">Java</option>
                    <option value="pdsa">PDSA</option>
                    <option value="sql">SQL</option>
                    <option value="system_commands">Sys Commands</option>
                    <option value="mlp">MLP</option>
                    <option value="c_prog">C Programming</option>
                    <option value="big_data">Big Data</option>
                    <option value="mlops">MLOPS</option>
                    <option value="tds">TDS</option>
                </select>
            </div>
            
            <div class="p-3 bg-[#0a0a0a] flex gap-2 border-b border-gray-800">
                <input v-model="searchQuery" type="text" placeholder="Search..." class="input-base py-2 text-xs rounded-full">
                <button @click="addNewQuestion()" class="w-8 h-8 flex-shrink-0 bg-purple-600 hover:bg-purple-500 rounded-full text-white flex items-center justify-center transition" title="Add Question">
                    <i class="fa-solid fa-plus text-xs"></i>
                </button>
            </div>

            <div class="flex-1 overflow-y-auto scroll-smooth p-2 space-y-1">
                <div v-for="q in filteredQuestions" :key="q.id" 
                     @click="loadQuestion(q)"
                     class="question-item p-3 rounded cursor-pointer group"
                     :class="currentQuestion?.id === q.id ? 'active' : ''">
                    <div class="flex justify-between items-center">
                        <h3 class="font-medium text-sm truncate pr-2 text-gray-300">{{ q.title || 'Untitled' }}</h3>
                        <span class="text-[10px] px-1.5 rounded bg-gray-800 text-gray-500">{{ q.difficulty }}</span>
                    </div>
                </div>
            </div>
            
            <div class="p-4 border-t border-gray-800">
                <button @click="saveFile" class="w-full py-2 bg-gray-800 hover:bg-gray-700 text-white rounded text-xs font-bold transition flex items-center justify-center gap-2">
                    <i class="fa-solid fa-floppy-disk"></i> Save All Changes
                </button>
            </div>
        </div>

        <!-- Middle: Editable Properties -->
        <div class="flex flex-col h-full bg-[#0a0a0a] border-r border-gray-800 overflow-y-auto p-6 scroll-smooth">
            <div v-if="currentQuestion" class="space-y-6 fade-in">
                
                <div class="flex justify-between items-center border-b border-gray-800 pb-4">
                    <h2 class="text-sm font-bold text-gray-500 uppercase tracking-widest">Definition</h2>
                    <button @click="deleteQuestion" class="text-red-500 hover:text-red-400 text-xs"><i class="fa-solid fa-trash"></i></button>
                </div>

                <div class="space-y-4">
                    <div>
                        <label class="block text-[10px] text-gray-600 font-bold uppercase mb-1">Question Title</label>
                        <input v-model="currentQuestion.title" class="input-base bg-[#111] font-bold text-lg text-white">
                    </div>
                    
                    <div>
                        <label class="block text-[10px] text-gray-600 font-bold uppercase mb-1">Difficulty</label>
                        <select v-model="currentQuestion.difficulty" class="input-base bg-[#111] text-xs w-1/2">
                            <option>Easy</option>
                            <option>Medium</option>
                            <option>Hard</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-[10px] text-gray-600 font-bold uppercase mb-1">Description (Markdown)</label>
                        <textarea v-model="currentQuestion.description" class="input-base h-32 font-mono text-xs bg-[#111] leading-relaxed"></textarea>
                    </div>

                    <div class="pt-4 border-t border-gray-800">
                         <div class="flex justify-between items-center mb-2">
                            <label class="block text-[10px] text-gray-600 font-bold uppercase">Starter Code</label>
                            <button @click="copyToStarter" class="text-[10px] text-indigo-400 hover:underline" title="Copy from Editor">
                                <i class="fa-solid fa-arrow-left"></i> Fetch from Editor
                            </button>
                        </div>
                        <textarea v-model="currentQuestion.starterCode" class="input-base h-32 font-mono text-[11px] bg-[#0f0f0f] text-gray-400"></textarea>
                        <p class="text-[10px] text-gray-600 mt-1">This is the code users will start with.</p>
                    </div>

                    <div class="pt-4 border-t border-gray-800">
                        <div class="flex justify-between items-center mb-3">
                             <label class="block text-[10px] text-gray-600 font-bold uppercase">Test Cases</label>
                             <button @click="addTestCase" class="text-purple-400 text-xs">+ Case</button>
                        </div>
                        <div class="space-y-3">
                            <div v-for="(tc, idx) in currentQuestion.testCases" :key="idx" class="flex gap-2 items-start bg-[#111] p-2 rounded border border-gray-800 group">
                                <span class="text-[10px] text-gray-600 pt-2">#{{ idx+1 }}</span>
                                <div class="flex-1 space-y-1">
                                    <input v-model="tc.input" placeholder="Input" class="input-base py-1 px-2 text-xs font-mono bg-[#0a0a0a]">
                                    <input v-model="tc.output" placeholder="Output" class="input-base py-1 px-2 text-xs font-mono bg-[#0a0a0a]">
                                </div>
                                <button @click="currentQuestion.testCases.splice(idx, 1)" class="text-gray-600 hover:text-red-500 text-xs opacity-0 group-hover:opacity-100"><i class="fa-solid fa-times"></i></button>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
            <div v-else class="flex flex-col items-center justify-center h-full text-gray-600 text-xs">
                Select a question to edit
            </div>
        </div>

        <!-- Right: Playground Editor -->
        <div class="flex flex-col h-full bg-[#0a0a0a] border-l border-gray-800">
            <!-- Toolbar -->
            <div class="flex justify-between items-center p-3 border-b border-gray-800 bg-[#111]">
                <div class="flex gap-2 text-xs text-gray-500 items-center">
                    <i class="fa-solid fa-terminal"></i>
                    <span class="font-mono">{{ getFileName() }}</span>
                </div>
                <div class="flex gap-3">
                    <button @click="runCode" :disabled="isRunning" class="px-4 py-1.5 bg-green-600 hover:bg-green-500 text-white text-xs font-bold rounded flex items-center gap-2 transition disabled:opacity-50">
                        <i v-if="!isRunning" class="fa-solid fa-play"></i>
                        <i v-else class="fa-solid fa-circle-notch fa-spin"></i>
                        Test Run
                    </button>
                </div>
            </div>

            <!-- Editor -->
            <div class="flex-1 relative editor-container text-sm">
                <textarea id="code-editor"></textarea>
            </div>

            <!-- Console -->
            <div class="h-1/3 border-t border-gray-800 bg-[#0f0f0f] flex flex-col">
                <div class="px-4 py-2 bg-[#151515] border-b border-gray-800 text-[10px] font-bold text-gray-500 uppercase flex justify-between">
                    <span>Output</span>
                    <button @click="consoleOutput = []" class="hover:text-white">Clear</button>
                </div>
                <div class="flex-1 p-4 font-mono text-xs overflow-y-auto whitespace-pre-wrap">
                     <div v-for="(line, idx) in consoleOutput" :key="idx" :class="line.type === 'error' ? 'text-red-400' : line.type === 'success' ? 'text-green-400' : 'text-gray-300'" class="mb-1">
                        {{ line.text }}
                     </div>
                </div>
            </div>
        </div>

    </div>

    <!-- Load Module -->
    <script type="module" src="./src/app.js"></script>
</body>
</html>
