<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PYQ Parser & Editor</title>
    <link rel="stylesheet" href="css/style.css">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <!-- PDF.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <script>pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';</script>

    <!-- KaTeX & Marked (for preview) -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/contrib/auto-render.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
    <div class="header" style="height: 60px; padding: 0 2rem; display: flex; align-items: center; justify-content: space-between; border-bottom: 1px solid var(--border);">
        <div class="flex items-center gap-4">
            <a href="index.html" class="btn"><i class="fas fa-home"></i></a>
            <h3>Parser / Editor</h3>
        </div>
        <div class="flex gap-2">
            <button class="btn btn-primary" id="save-json-btn"><i class="fas fa-download"></i> Download JSON</button>
        </div>
    </div>

    <div class="editor-layout">
        <!-- Left Pane: PDF Viewer -->
        <div class="flex flex-col" style="border-right: 1px solid var(--border); overflow: hidden;">
            <div class="tool-bar justify-between">
                <input type="file" id="pdf-upload" accept=".pdf" class="hidden">
                <button class="btn" onclick="document.getElementById('pdf-upload').click()">
                    <i class="fas fa-file-pdf"></i> Load PDF
                </button>
                
                <div class="flex gap-2">
                    <button class="btn" id="prev-page"><i class="fas fa-chevron-left"></i></button>
                    <span id="page-num" class="flex items-center">Page 1</span>
                    <button class="btn" id="next-page"><i class="fas fa-chevron-right"></i></button>
                </div>
            </div>
            
            <div id="pdf-container" style="flex:1; overflow: auto; background: #333; text-align: center; padding: 1rem;">
                <canvas id="the-canvas" style="border: 1px solid #000; max-width: 100%;"></canvas>
            </div>
        </div>

        <!-- Right Pane: Exam Editor -->
        <div class="flex flex-col" style="overflow: hidden;">
            <div class="tool-bar flex-col gap-4" style="height: auto;">
                <div class="flex gap-2">
                    <select id="subject-select">
                        <option value="">Select Subject...</option>
                        <!-- Populated via JS -->
                    </select>
                    <input type="text" id="exam-id" placeholder="ID (e.g. ma1-q1-22)">
                    <input type="text" id="exam-year" placeholder="Year" style="width: 80px;">
                </div>
                <input type="text" id="exam-title-input" placeholder="Exam Title (e.g. Math 1 - Quiz 1)">
            </div>

            <div id="questions-list" style="flex: 1; overflow-y: auto; padding: 1rem;">
                <!-- Questions injected here -->
            </div>

            <div style="padding: 1rem; border-top: 1px solid var(--border); background: var(--bg-card);">
                <button class="btn btn-primary w-full" id="add-question-btn"><i class="fas fa-plus"></i> Add Question</button>
            </div>
        </div>
    </div>

    <!-- Image Processor Modal -->
    <div id="img-modal" class="hidden image-editor-modal">
        <div class="image-editor-content">
            <h3>Image Processor</h3>
            <input type="file" id="img-input" accept="image/*">
            <div style="max-height: 400px; overflow: auto; border: 1px dashed #666;">
                <img id="img-preview" src="" alt="Preview">
            </div>
            <div class="flex gap-4">
                <label>Quality: <input type="number" id="img-quality" value="0.7" step="0.1" max="1" min="0.1"></label>
                <label>Max Width: <input type="number" id="img-width" value="800"></label>
            </div>
            <div class="flex justify-end gap-2">
                <button class="btn" onclick="document.getElementById('img-modal').classList.add('hidden')">Cancel</button>
                <button class="btn btn-primary" id="process-img-btn">Process & Download</button>
            </div>
        </div>
    </div>

    <script type="module" src="js/parser.js"></script>
</body>
</html>
