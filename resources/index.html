<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IITM | Resources Manager</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Outfit', sans-serif; background-color: #050505; color: #e5e5e5; }
        .glass { background: rgba(30, 30, 30, 0.6); backdrop-filter: blur(12px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .input-field { background: #1a1a1a; border: 1px solid #333; color: white; padding: 0.5rem 1rem; border-radius: 0.5rem; width: 100%; outline: none; transition: all 0.3s; }
        .input-field:focus { border-color: #3b82f6; box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2); }
    </style>
</head>
<body class="min-h-screen p-6 relative overflow-x-hidden">

    <div id="app" class="max-w-7xl mx-auto">
        <header class="flex justify-between items-center mb-8">
            <div>
                <h1 class="text-3xl font-bold bg-gradient-to-r from-blue-400 to-cyan-500 bg-clip-text text-transparent">Resources Manager</h1>
                <p class="text-gray-400 text-sm mt-1">Manage Links & Notes</p>
            </div>
            <div class="flex gap-3">
                <button @click="loadFile" class="px-4 py-2 rounded-lg bg-gray-800 hover:bg-gray-700 border border-gray-700 text-sm">Reload</button>
                <button @click="saveFile" class="px-4 py-2 rounded-lg bg-blue-600 hover:bg-blue-500 text-sm font-medium shadow-lg shadow-blue-500/20">Save JSON</button>
                <button @click="openNewModal" class="px-4 py-2 rounded-lg bg-emerald-600 hover:bg-emerald-500 text-sm font-medium shadow-lg shadow-emerald-500/20">Add Resource</button>
            </div>
        </header>

         <!-- Notification -->
        <div v-if="notification" class="fixed top-6 right-6 z-50 px-4 py-3 rounded-lg shadow-xl border border-gray-700 bg-gray-900 text-white flex items-center gap-3 animate-bounce-in">
            <span class="text-emerald-400">âœ“</span> {{ notification }}
        </div>

        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
            <div v-for="item in items" :key="item.id" class="glass rounded-xl p-6 hover:border-blue-500/50 transition duration-300 group relative">
                <div class="absolute top-4 right-4 flex gap-2 opacity-0 group-hover:opacity-100 transition">
                    <button @click="editItem(item)" class="p-2 rounded bg-gray-800 hover:text-blue-400 transition">Edit</button>
                    <button @click="deleteItem(item.id)" class="p-2 rounded bg-gray-800 hover:text-red-400 transition">Del</button>
                </div>
                
                <div class="flex justify-between items-center mb-3">
                    <span class="text-xs font-bold px-2 py-1 rounded bg-blue-500/20 text-blue-400 border border-blue-500/30">{{ item.type }}</span>
                    <span class="text-xs text-gray-500">{{ item.subject }}</span>
                </div>

                <h3 class="text-lg font-bold mb-2">{{ item.title }}</h3>
                <p class="text-sm text-gray-400 mb-4 line-clamp-2">{{ item.description }}</p>
                
                <a :href="item.url" target="_blank" class="text-xs text-blue-400 hover:underline break-all">{{ item.url }}</a>
            </div>
        </div>

        <!-- Modal -->
        <div v-if="editingItem" class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm">
            <div class="bg-[#111] border border-gray-800 rounded-xl w-full max-w-lg p-8 shadow-2xl relative">
                <h2 class="text-xl font-bold mb-6 text-blue-500">{{ isNew ? 'Add Resource' : 'Edit Resource' }}</h2>
                
                <div class="space-y-4">
                    <div>
                        <label class="block text-xs font-medium text-gray-500 mb-1">Title</label>
                        <input v-model="editingItem.title" class="input-field" type="text">
                    </div>
                    <div class="grid grid-cols-2 gap-4">
                        <div>
                            <label class="block text-xs font-medium text-gray-500 mb-1">Type</label>
                            <select v-model="editingItem.type" class="input-field">
                                <option>Video</option>
                                <option>Notes</option>
                                <option>PYQ</option>
                                <option>Book</option>
                                <option>Other</option>
                            </select>
                        </div>
                        <div>
                             <label class="block text-xs font-medium text-gray-500 mb-1">Subject</label>
                             <input v-model="editingItem.subject" class="input-field" type="text">
                        </div>
                    </div>
                     <div>
                        <label class="block text-xs font-medium text-gray-500 mb-1">URL</label>
                        <input v-model="editingItem.url" class="input-field" type="text">
                    </div>
                     <div>
                        <label class="block text-xs font-medium text-gray-500 mb-1">Description</label>
                        <textarea v-model="editingItem.description" class="input-field h-24"></textarea>
                    </div>
                </div>

                <div class="mt-8 flex justify-end gap-3">
                    <button @click="editingItem = null" class="px-4 py-2 rounded-lg border border-gray-700 hover:bg-gray-800">Cancel</button>
                    <button @click="saveItem" class="px-4 py-2 rounded-lg bg-blue-600 hover:bg-blue-500 text-white">Save</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const { createApp } = Vue;
        createApp({
            data() { return { items: [], editingItem: null, isNew: false, notification: null } },
            mounted() { this.loadFile(); },
            methods: {
                async loadFile() { try { const res = await fetch('./items.json'); if(res.ok) this.items = await res.json(); } catch(e){} },
                openNewModal() { this.isNew = true; this.editingItem = { id: Date.now().toString(), title: '', type: 'Video', subject: '', url: '#', description: '' }; },
                editItem(item) { this.isNew = false; this.editingItem = JSON.parse(JSON.stringify(item)); },
                saveItem() {
                    if(this.isNew) this.items.push(this.editingItem);
                    else { const idx = this.items.findIndex(i => i.id === this.editingItem.id); if(idx!==-1) this.items[idx]=this.editingItem; }
                    this.editingItem = null;
                   this.showNotification('Resource saved locally!');
                },
                deleteItem(id) { if(confirm("Delete?")) this.items = this.items.filter(i => i.id !== id); },
                async saveFile() {
                    try { const h = await window.showSaveFilePicker({ suggestedName: 'items.json' }); const w = await h.createWritable(); await w.write(JSON.stringify(this.items, null, 2)); await w.close(); this.showNotification('Saved to items.json'); }
                    catch(e) { const blob = new Blob([JSON.stringify(this.items,null,2)],{type:'application/json'}); const a = document.createElement('a'); a.href = URL.createObjectURL(blob); a.download='items.json'; a.click(); }
                },
                showNotification(msg) { this.notification = msg; setTimeout(()=>this.notification=null, 3000); }
            }
        }).mount('#app');
    </script>
</body>
</html>
